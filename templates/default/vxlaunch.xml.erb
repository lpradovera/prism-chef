<?xml version="1.0" encoding="UTF-8"?>
<!-- Auto-generated by Chef for <%= node[:fqdn] %> -->
<config version="1.0">
  <category name="config">
    <category name="VxLaunch">
      <item name="RuntimeMode"><%=node[:prism][:runtime_mode]%></item>
      <item name="HTTPCtrlPort" type="int"> <%= node[:prism][:VxLaunch][:http_control_port] %></item>
      <item name="SCMServiceName"> smanager </item>
      <category name="GlobalThreadPool">
        <item name="InitialSize">5</item>
      </category>
    </category>
    <category name="Log">
      <item name="AlertUri"> </item>
      <item name="MeterAlarmThreshold" type="int">64</item>
      <item name="MeteringEncryptionKey"></item>
      <item name="MeteringLogFile"> <%=@prism_home%>/logs/metering_cannot_send.log </item>
      <item name="MeteringLoggerAddress0"></item>
      <item name="EncryptionKey"></item>
      <item name="FileBase"> <%=@prism_home%>/logs </item>
      <item name="MaskDebug" type="int">2</item>
      <item name="MaskHighLevel" type="int">2</item>
      <item name="MaskLowLevel" type="int">2</item>
      <item name="MaskSession" type="int">2</item>
      <item name="MaskUser" type="int">6</item>
      <item name="MaxFileSize" type="int"> <%= node[:prism][:VxLaunch][:Log][:max_file_size] %> </item>
      <item name="MaxNumOfFiles" type="int"> <%= node[:prism][:VxLaunch][:Log][:max_num_of_files] %> </item>
      <item name="RetryDelay" type="int"> 5 </item>
      <item name="SysLogEnabled" type="int"> 1 </item>
      <item name="SysLogFilter" type="int">-1</item>
      <item name="SysLogBroadCast" type="int">1</item>
      <% node[:prism][:VxLaunch][:Log][:syslog_servers].each_with_index do |host,index| -%>
      <item name='SysLogServer<%=index%>'><%=host%></item>
      <% end -%>
      <item name="SplunkEnabled">1</item>
    </category>
  </category>
  <category name="Commands">
  <% if node[:prism][:VxLaunch][:rtmpd][:enabled] -%>
      <category name="rtmpd">
      <item name="LongName">RTMPD</item>
      <item name="exe" platform="linux"><%=node[:prism][:rtmpd][:dir]%>/rtmpserver</item>
      <item name="Default" platform="linux"><%=node[:prism][:rtmpd][:dir]%>/rtmpserver.lua</item>
      <item name="cwd">2</item>
      <item name="CwdDir"><%=node[:prism][:rtmpd][:dir]%></item>
      <item name="description"> Launches RTMPD </item>
      <item name="StartupTimeout" type="int">30</item>
      <item name="ShutdownOptions" type="int">4</item>
      <item name="ShutdownTimeout" type="int">30</item>
      <item name="SyslogServer">1</item>
      <item name="ExitCodes"/>
      <item name="AppType" type="int">65</item>
      <item name="Priority"> </item>
    </category>
  <% end -%>
   <% if node[:prism][:VxLaunch][:panda][:enabled] -%>
    <category name="panda">
      <item name="LongName">Panda</item>
      <item name="exe" platform="linux"><%=node[:prism][:panda][:dir]%>/bin/bamboo.py</item>
      <item name="Default" platform="linux"><%=node[:prism][:panda][:dir]%>/conf/bamboo.conf</item>
      <item name="cwd">2</item>
      <item name="CwdDir"><%=node[:prism][:panda][:dir]%></item>
      <item name="description"> Launches Panda </item>
      <item name="StartupTimeout" type="int">30</item>
      <item name="ShutdownOptions" type="int">4</item>
      <item name="ShutdownTimeout" type="int">30</item>
      <item name="SyslogServer">1</item>
      <item name="ExitCodes"/>
      <item name="AppType" type="int">65</item>
      <item name="Priority"> </item>
    </category>
  <% end -%>
    <category name="as-debug">
      <item name="LongName"> Voxeo Prism Application Server Debug Mode </item>
      <item name="Java"> true </item>
      <item name="OpenFileMax" platform="linux" type="int"><%= node[:prism][:VxLaunch][:Commands][:as_debug][:OpenFileMax] %></item>
      <category name="java">
        <category name="classpath">
          <item><%=@prism_home%>/lib/jars/*.jar</item>
          <item platform="osx" name="15">/Library/Java/Home/lib/tools.jar</item>
          <item platform="linux" name="16"><%=@prism_home%>/jre/lib/tools.jar</item>
          <item platform="win" name="17"><%=@prism_home%>\jre\lib\tools.jar</item>
          <item><%=@prism_home%>/conf</item>
        </category>
        <category name="properties">
          <item name="product-name">prism</item>
          <item name="com.sun.management.jmxremote"/>
          <item name="java.endorsed.dirs"><%=@prism_home%>/common/endorsed</item>
          <item name="java.library.path"><%=@prism_home%>/lib</item>
          <item platform="osx" name="kernel.home"><%=@prism_home%></item>
          <item platform="linux" name="kernel.home"><%=@prism_home%></item>
          <item platform="win" name="kernel.home"><%=@prism_home%></item>
          <item name="wrapper.native_library">wrapper</item>
          <item name="wrapper.version">3.2.3</item>
          <item name="log4j.ignoreTCL">true</item>
          <item name="java.net.preferIPv4Stack">true</item>
          <item name="java.util.logging.config.file"><%=@prism_home%>/conf/logging.properties</item>
          <item name="java.rmi.server.RMIClassLoaderSpi">com.micromethod.sipmethod.server.SIPMethodRMIClassLoaderSpi</item>
          <item name="org.tanukisoftware.wrapper.WrapperSimpleApp.waitForStartMain">TRUE</item>
          <item name="com.voxeo.sipmethod.server.launcher.main.block">true</item>
          <item platform="linux" name="java.security.egd">file:/dev/./urandom</item>
          <item platform="osx" name="java.awt.headless">true</item>
		      <item name="dnsjava.options">multiline=true,verbose=true,verbosemsg=true,verbosecache=true</item>
        </category>
      </category>
      <item name="exe" platform="linux">   <%=@prism_home%>/jre/bin/java  </item>
      <item name="exe" platform="osx">      /Library/Java/Home/bin/java</item>
      <item name="exe" platform="win">     <%=@prism_home%>\jre\bin\java.exe  </item>
      <item name="description"> Launches Voxeo Prism Application Server Debug Model</item>
      <item name="Invoke" platform="linux"> -server -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=y -Xms<%= node[:prism][:VxLaunch][:Commands][:as_debug][:Xms]%> -Xmx<%= node[:prism][:VxLaunch][:Commands][:as_debug][:Xmx]%> -XX:NewRatio=2 -XX:SurvivorRatio=2 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:MaxPermSize=<%= node[:prism][:VxLaunch][:Commands][:as_debug][:MaxPermSize] %> -XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled org.tanukisoftware.wrapper.WrapperSimpleApp com.micromethod.sipmethod.server.Launcher -start</item>
      <item name="AppType" type="int">0</item>
      <item name="ExitCodes"> ,7056,143, </item>
      <item name="StartupTimeout" type="int">600</item>
      <item name="ShutdownTimeout" type="int">120</item>
      <item name="ShutdownOptions" type="int">3</item>
      <item name="RestartOnChange"> license </item>
      <item name="Priority"> </item>
      <item name="SyslogServer">1</item>
      <category name="wrapper">
        <item name="wrapper.startup.timeout">600</item>
        <item name="wrapper.shutdown.timeout">10</item>
        <item name="wrapper.logfile"><%=@prism_home%>/logs/wrapper.log</item>
      </category>
    </category>
    <category name="ms">
      <item name="LongName">Voxeo Prism Media Server</item>
      <item name="exe" platform="linux">  <%=@prism_home%>/bin/VCS </item>
      <item name="exe" platform="osx">    <%=@prism_home%>/bin/VCS </item>
      <item name="exe" platform="win">    <%=@prism_home%>\bin\vcs.exe </item>
      <item name="description"> Launches Voxeo Prism Media Server</item>
      <item name="Default" platform="linux">--product-name  Prism   --base-dir <%=@prism_home%>  --config-dir <%=@prism_home%>/conf  --log-dir <%=@prism_home%>/logs --lib-dir <%=@prism_home%>/lib </item>
      <item name="Default" platform="osx"> --product-name  Prism  --base-dir <%=@prism_home%>  --config-dir <%=@prism_home%>/conf  --log-dir <%=@prism_home%>/logs --lib-dir <%=@prism_home%>/lib </item>
      <item name="Default" platform="win"> --product-name  Prism  --base-dir "<%=@prism_home%>"  --config-dir "<%=@prism_home%>"/conf  --log-dir "<%=@prism_home%>"/logs/ --lib-dir "<%=@prism_home%>"/lib </item>
      <item name="StartupName"> VCSStartupEvent </item>
      <item name="StartupTimeout" type="int"> 120 </item>
      <item name="ShutdownName" platform="linux"> </item>
      <item name="ShutdownName" platform="osx"> </item>
      <item name="ShutdownName" platform="win"> VCSShutdownEvent</item>
      <item name="ShutdownTimeout" type="int">30</item>
      <item name="ShutdownOptions" platform="linux" type="int">4</item>
      <item name="ShutdownOptions" platform="osx" type="int">4</item>
      <item name="ShutdownOptions" platform="win" type="int">0</item>
      <item name="RestartOnChange"> license </item>
      <item name="ExitCodes"> ,7056,161, </item>
      <item name="AppType" type="int">65</item>
      <item name="AlwaysReport" type="int">0</item>
      <item name="OpenFile" platform="linux" type="int">10</item>
      <item name="Priority"> </item>
      <% if @glibc_hack -%>
      <category name="envproperties">
       <item name="MALLOC_ARENA_TEST" platform="linux"> 0 </item>
       <item name="MALLOC_ARENA_MAX" platform="linux"> 4 </item>
      </category>
      <%end-%>
    </category>
    <category name="as">
      <item name="LongName"> Voxeo Prism Application Server </item>
      <item name="Java"> true </item>
      <item name="OpenFileMax" platform="linux" type="int"><%= node[:prism][:VxLaunch][:Commands][:as][:OpenFileMax] %></item>
      <category name="java">
        <category name="classpath">
          <item><%=@prism_home%>/lib/jars/*.jar</item>
          <item platform="osx" name="15">/Library/Java/Home/lib/tools.jar</item>
          <item platform="linux" name="16"><%=@prism_home%>/jre/lib/tools.jar</item>
          <item platform="win" name="17"><%=@prism_home%>\jre\lib\tools.jar</item>
          <item><%=@prism_home%>/conf</item>
        </category>
        <category name="properties">
          <item name="voxeo.config-dir"><%=@prism_home%>/conf</item>
          <item name="product-name">prism</item>
          <item name="com.sun.management.jmxremote"/>
          <item name="java.endorsed.dirs"><%=@prism_home%>/common/endorsed</item>
          <item name="java.library.path"><%=@prism_home%>/lib</item>
          <item platform="osx" name="kernel.home"><%=@prism_home%></item>
          <item platform="linux" name="kernel.home"><%=@prism_home%></item>
          <item platform="win" name="kernel.home"><%=@prism_home%></item>
          <item name="wrapper.native_library">wrapper</item>
          <item name="wrapper.version">3.2.3</item>
          <item name="log4j.ignoreTCL">true</item>
          <item name="java.net.preferIPv4Stack">true</item>
          <item name="java.util.logging.config.file"><%=@prism_home%>/conf/logging.properties</item>
          <item name="org.tanukisoftware.wrapper.WrapperSimpleApp.waitForStartMain">TRUE</item>
          <item name="sun.net.inetaddr.ttl"><%= node[:prism][:VxLaunch][:as][:cache] %></item>
          <item name="sun.net.client.defaultReadTimeout"><%= node[:prism][:VxLaunch][:as][:default_read_timeout] %></item>
          <item name="sun.net.client.defaultConnectTimeout"><%= node[:prism][:VxLaunch][:as][:default_connect_timeout] %></item>
          <item name="java.rmi.server.RMIClassLoaderSpi">com.micromethod.sipmethod.server.SIPMethodRMIClassLoaderSpi</item>
          <% if node[:prism][:VxLaunch][:debug_logging] -%>
          <item name="com.micromethod.sipmethod.server.cluster.logmc">true</item>
          <% end -%>
          <item name="com.voxeo.sipmethod.server.launcher.main.block">true</item>
          <item platform="linux" name="java.security.egd">file:/dev/./urandom</item>
          <item platform="osx" name="java.awt.headless">true</item>
		      <item name="dnsjava.options">multiline=true,verbose=true,verbosemsg=true,verbosecache=true</item>
        </category>
      </category>
      <item name="exe" platform="linux"> <%=@prism_home%>/jre/bin/java  </item>
      <item name="exe" platform="osx"> /Library/Java/Home/bin/java</item>
      <item name="exe" platform="win"> <%=@prism_home%>\jre\bin\java.exe  </item>
      <item name="description"> Launches Voxeo Prism Application Server</item>
      <item name="Invoke" platform="linux"> -server -Xms<%= node[:prism][:VxLaunch][:Commands][:as][:Xms]%> -Xmx<%= node[:prism][:VxLaunch][:Commands][:as][:Xmx]%> -XX:NewRatio=2 -XX:SurvivorRatio=2 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:MaxPermSize=<%=node[:prism][:VxLaunch][:Commands][:as][:MaxPermSize]%> -XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled org.tanukisoftware.wrapper.WrapperSimpleApp com.micromethod.sipmethod.server.Launcher -start</item>
      <item name="AppType" type="int">65</item>
      <item name="ExitCodes"> ,7056,143, </item>
      <item name="StartupTimeout" type="int">600</item>
      <item name="ShutdownTimeout" type="int">120</item>
      <item name="ShutdownOptions" type="int">3</item>
      <item name="RestartOnChange"> license </item>
      <item name="Priority"> </item>
      <item name="SyslogServer">1</item>
      <category name="wrapper">
        <item name="wrapper.startup.timeout">600</item>
        <item name="wrapper.shutdown.timeout">10</item>
        <item name="wrapper.logfile"><%=@prism_home%>/logs/wrapper.log</item>
      </category>
      <% if @glibc_hack -%>
      <category name="envproperties">
       <item name="MALLOC_ARENA_TEST" platform="linux"> 0 </item>
       <item name="MALLOC_ARENA_MAX" platform="linux"> 4 </item>
      </category>
      <%end-%>
    </category>
  </category>
</config>
